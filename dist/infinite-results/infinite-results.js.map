{"version":3,"sources":["../../src/infinite-results/infinite-results.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,OAAO,EACL,SAAS,EACT,YAAY,EACZ,KAAK,EACL,WAAW,EACX,MAAM,EACN,WAAW,EACZ,MAAM,eAAA,CAAgB;AACvB,OAAO,EAAE,mBAAA,EAAoB,MAAO,gCAAA,CAAiC;AACrE,OAAO,EAAE,IAAA,EAAM,UAAA,EAAW,MAAO,WAAA,CAAY;AAE7C,OAAO,EAAE,UAAA,EAAW,MAAO,gBAAA,CAAiB;AAC5C,OAAO,EAAE,aAAA,EAAc,MAAO,yCAAA,CAA0C;AAGxE;IAA0C,wCAAU;IAoBlD,8BACU,UAAkB,EAC1B,cAA6B;QAF/B,YAIE,kBAAM,cAAc,EAAE,iBAAiB,CAAC,SAEzC;QALS,gBAAU,GAAV,UAAU,CAAQ;QAlB5B,iBAAiB;QACT,mBAAa,GAAW,mBAAmB,CAAC;QAGpD,6CAA6C;QACtC,WAAK,GAKR;YACF,IAAI,EAAE,EAAE;YACR,UAAU,EAAE,KAAK;YACjB,QAAQ,EAAE,IAAI;YACd,OAAO,EAAE,EAAE;SACZ,CAAC;QAeF,iBAAW,GAAG,UACZ,KAA2E,EAC3E,gBAAyB;YAEzB,EAAE,CAAC,CAAC,gBAAgB,CAAC;gBAAC,MAAM,CAAC;YAE7B,KAAI,CAAC,KAAK,gBACL,KAAK,IACR,OAAO,EAAE,KAAK,CAAC,OAAO,EACtB,IAAI,EAAE,UAAU,CAAC,KAAI,CAAC,cAAc,CAAC;oBACnC,CAAC,CAAC,KAAI,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC;oBACjC,CAAC,CAAC,KAAK,CAAC,IAAI,GACf,CAAC;QACJ,CAAC,CAAC;QArBA,KAAI,CAAC,YAAY,CAAC,mBAAmB,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;;IAC/D,CAAC;IAEM,uCAAQ,GAAf,UAAgB,KAAiB;QAC/B,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;IACxB,CAAC;IAgBI,+BAAU,GAA0B;QAC3C,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;oBACxB,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,88BA+BT;iBACF,EAAG,EAAE;KACL,CAAC;IACF,kBAAkB;IACX,mCAAc,GAAmE,cAAM,OAAA;QAC9F,EAAC,IAAI,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,WAAW,EAAG,EAAE,EAAG,EAAC;QACvE,EAAC,IAAI,EAAE,aAAa,GAAG;KACtB,EAH6F,CAG7F,CAAC;IACK,mCAAc,GAA2C;QAChE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,WAAW,EAAG,EAAE,EAAE;QAC5D,eAAe,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QACnC,gBAAgB,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;KACnC,CAAC;IACF,2BAAC;CA9FD,AA8FC,CA9FyC,UAAU,GA8FnD;SA9FY,oBAAoB","file":"infinite-results.js","sourceRoot":"","sourcesContent":["import {\n  Component,\n  ContentChild,\n  Input,\n  TemplateRef,\n  Inject,\n  PLATFORM_ID\n} from \"@angular/core\";\nimport { connectInfiniteHits } from \"instantsearch.js/es/connectors\";\nimport { noop, isFunction } from \"lodash-es\";\n\nimport { BaseWidget } from \"../base-widget\";\nimport { NgAisInstance } from \"../instantsearch/instantsearch-instance\";\n\n\nexport class NgAisInfiniteResults extends BaseWidget {\n   public template?: any;\n\n  // render options\n   public showMoreLabel: string = \"Show more results\";\n   public transformItems?: Function;\n\n  // inner widget state returned from connector\n  public state: {\n    hits: {}[];\n    isLastPage: boolean;\n    showMore: Function;\n    results: {};\n  } = {\n    hits: [],\n    isLastPage: false,\n    showMore: noop,\n    results: {}\n  };\n\n  constructor(\n     public platformId: Object,\n    searchInstance: NgAisInstance\n  ) {\n    super(searchInstance, \"InfiniteResults\");\n    this.createWidget(connectInfiniteHits, { escapeHits: true });\n  }\n\n  public showMore(event: MouseEvent) {\n    event.preventDefault();\n    this.state.showMore();\n  }\n\n  updateState = (\n    state: { hits: {}[]; results: {}; isLastPage: boolean; showMore: Function },\n    isFirstRendering: boolean\n  ) => {\n    if (isFirstRendering) return;\n\n    this.state = {\n      ...state,\n      results: state.results,\n      hits: isFunction(this.transformItems)\n        ? this.transformItems(state.hits)\n        : state.hits\n    };\n  };\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: \"ng-ais-infinite-results\",\n  template: `\n    <div [class]=\"cx()\">\n      <ng-ais-header [header]=\"header\" [className]=\"cx('header')\"></ng-ais-header>\n\n      <div [class]=\"cx('body')\">\n        <ng-container *ngTemplateOutlet=\"template; context: state\"></ng-container>\n\n        <!-- default rendering if no template specified -->\n        <div *ngIf=\"!template\">\n          <ul [class]=\"cx('list')\">\n            <li\n              [class]=\"cx('item')\"\n              *ngFor=\"let hit of state.hits\"\n            >\n              <ng-ais-highlight attributeName=\"name\" [hit]=\"hit\">\n              </ng-ais-highlight>\n            </li>\n          </ul>\n        </div>\n\n        <button\n          [class]=\"cx('showMore')\"\n          (click)=\"showMore($event)\"\n          [disabled]=\"state.isLastPage\"\n        >\n          {{showMoreLabel}}\n        </button>\n      </div>\n\n      <ng-ais-footer [footer]=\"footer\" [className]=\"cx('footer')\"></ng-ais-footer>\n    </div>\n  `\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID, ] }, ]},\n{type: NgAisInstance, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'template': [{ type: ContentChild, args: [TemplateRef, ] },],\n'showMoreLabel': [{ type: Input },],\n'transformItems': [{ type: Input },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}