{"version":3,"sources":["../../src/range-slider/range-slider.ts"],"names":[],"mappings":"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","file":"range-slider.js","sourceRoot":"","sourcesContent":["import {\n  Component,\n  Input,\n  ViewChild,\n  Inject,\n  PLATFORM_ID\n} from \"@angular/core\";\nimport { connectRange } from \"instantsearch.js/es/connectors\";\nimport { isPlainObject, noop, omit } from \"lodash-es\";\nimport * as noUiSlider from \"nouislider\";\n\nimport { BaseWidget } from \"../base-widget\";\nimport { NgAisInstance } from \"../instantsearch/instantsearch-instance\";\nimport { parseNumberInput } from \"../utils\";\n\nexport type RangeSliderState = {\n  range: { min: number; max: number };\n  refine: Function;\n  start: number[];\n};\n\n\nexport class NgAisRangeSlider extends BaseWidget {\n   public sliderContainer: any;\n\n  // render options\n   public pips: boolean = true;\n   public tooltips: boolean = true;\n\n  // connector options\n   public attributeName: string;\n   public min?: number | string;\n   public max?: number | string;\n   public precision?: number | string = 2;\n\n  public state: RangeSliderState = {\n    range: { min: 0, max: 1 },\n    refine: noop,\n    start: [0, 1]\n  };\n\n  private slider: any;\n\n  get step() {\n    // compute step from the precision value\n    return 1 / Math.pow(10, parseNumberInput(this.precision));\n  }\n\n  constructor(\n     public platformId: Object,\n    searchInstance: NgAisInstance\n  ) {\n    super(searchInstance, \"RangeSlider\");\n  }\n\n  public ngOnInit() {\n    this.createWidget(connectRange, {\n      attributeName: this.attributeName,\n      max: parseNumberInput(this.max),\n      min: parseNumberInput(this.min),\n      precision: parseNumberInput(this.precision)\n    });\n\n    super.ngOnInit();\n  }\n\n  public updateState = (state: RangeSliderState, isFirstRendering: boolean) => {\n    if (isFirstRendering) {\n      // create slider\n      const config = {\n        animate: false,\n        behaviour: \"snap\",\n        connect: true,\n        range: { min: 0, max: 1 },\n        start: [0, 1],\n        step: this.step,\n        tooltips: this.tooltips && [\n          { to: this.formatTooltip },\n          { to: this.formatTooltip }\n        ]\n      };\n\n      if (this.pips === true || typeof this.pips === \"undefined\") {\n        Object.assign(config, {\n          pips: {\n            density: 3,\n            mode: \"positions\",\n            stepped: true,\n            values: [0, 50, 100]\n          }\n        });\n      } else if (isPlainObject(this.pips)) {\n        Object.assign(config, { pips: this.pips });\n      }\n\n      this.slider = noUiSlider.create(\n        this.sliderContainer.nativeElement,\n        config\n      );\n\n      // register listen events\n      this.sliderContainer.nativeElement.noUiSlider.on(\n        \"change\",\n        this.handleChange\n      );\n    }\n\n    // update component inner state\n    this.state = state;\n\n    // update the slider state\n    const { range: { min, max }, start } = state;\n\n    const disabled = min === max;\n    const range = disabled ? { min, max: max + 0.0001 } : { min, max };\n\n    this.slider.updateOptions({ disabled, range, start });\n  };\n\n  public handleChange = (values: string[] | number[]) => {\n    this.state.refine(values);\n  };\n\n  public formatTooltip = (value: number) => {\n    return value.toFixed(parseNumberInput(this.precision));\n  };\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: \"ng-ais-range-slider\",\n  template: `\n    <div [class]=\"cx()\">\n      <ng-ais-header [header]=\"header\" [className]=\"cx('header')\"></ng-ais-header>\n\n      <div [class]=\"cx('body')\">\n        <div #sliderContainer></div>\n      </div>\n\n      <ng-ais-footer [footer]=\"footer\" [className]=\"cx('footer')\"></ng-ais-footer>\n    </div>\n  `\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID, ] }, ]},\n{type: NgAisInstance, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'sliderContainer': [{ type: ViewChild, args: [\"sliderContainer\", ] },],\n'pips': [{ type: Input },],\n'tooltips': [{ type: Input },],\n'attributeName': [{ type: Input },],\n'min': [{ type: Input },],\n'max': [{ type: Input },],\n'precision': [{ type: Input },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}